<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Профіль користувача JWT</title>
  <link rel="stylesheet" href="/css/bootstrap.min.css">
</head>
<body>
  <div class="container mt-5">
    <a href="/index.html" class="btn btn-link">На головну</a>
    <h1 class="text-center">Профіль JWT</h1>
    <div id="jwtData" class="mt-4 p-3 border bg-light">
      <h4>Дані з токена:</h4>
      <pre id="tokenContent">Токен ще не отримано</pre>
    </div>
    <a href="/register.html" class="btn btn-link mt-3">Назад</a>
  </div>

  <script>
    function getCookie(name) {
      const value = `; ${document.cookie}`;
      const parts = value.split(`; ${name}=`);
      if (parts.length == 2) return parts.pop().split(';').shift();
      return null;
    }

    function parseJwt(token) {
      try {
        const base64 = token.split('.')[1];
        const decoded = atob(base64);
        return JSON.parse(decoded);
      } 
      catch (e) {
        return null;
      }
    }

    const token = getCookie("jwt");
    const payload = parseJwt(token);

    if (payload) {
      document.getElementById("tokenContent").textContent = JSON.stringify(payload, null, 2);
    } else {
      document.getElementById("tokenContent").textContent = "Токен не знайдено або він некоректний";
    }
  </script>
</body>
</html>